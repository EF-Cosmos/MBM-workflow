# 白给的工具 - 功能手册 (MBM Workflow Manual)

本手册详细介绍了 “白给的工具” Blender 插件的功能模块与操作逻辑。该插件专为 Minecraft 开发者 and 创作者设计，旨在简化 Blender 与 Minecraft 之间的数据交互与模型转换过程。

## 1. 核心面板概述
插件位于 Blender 的 **3D 视图 (3D View) > 侧栏 (Sidebar) > MBM_workflow** 选项卡中。
核心模块包括：
- **方块 (Block)**：基础方块数据处理。
- **导入 (Import)**：支持多种 Minecraft 结构与世界数据的导入。
- **导出 (Export)**：将 Blender 中的模型回传至 Minecraft。
- **创建存档 (Level Creation)**：直接在 Blender 中配置并生成 Minecraft 存档。
- **编辑 (Edit)**：功能强大的转换与可视化编辑工具。
- **Mod 设置 (Mod Panel)**：环境配置与资源包管理。

---

## 2. 导入功能 (Import)

### 2.1 导入 .schem 文件
- **逻辑**：支持解析标准的 `.schem` 结构文件。
- **多进程处理**：对于超过 1,000,000 个方块的大型结构，插件会自动启用多进程并行导入，极大提升加载速度。
- **分离选项**：
  - **按方块状态分离**：将不同类型的方块拆分为独立的对象。
  - **按区块分离**：按 16x16 区块进行组织，方便管理大型地图。

### 2.2 导入 Minecraft 世界 (Import World)
- **操作**：通过输入最小/最大坐标 (Min/Max Coordinates)，直接从指定的 MC 存档中提取地形。
- **合并选项**：勾选“合并重叠顶点 (Weld)”可优化导入后的网格，减少冗余数据。

### 2.3 其他导入支持
- **.nbt 文件**：支持标准 NBT 结构导入。
- **.json 文件**：用于导入特定的方块数据或元数据。

---

## 3. 导出功能 (Export)

### 3.1 导出为 .schem
- **逻辑**：将 Blender 中选中的对象转换为 Minecraft 可识别的 `.schem` 格式。

### 3.2 导出到存档 (Export to Save)
- **便捷性**：无需手动移动文件。在“选择世界”下拉菜单中选择目标存档，点击“导出结构到存档”即可直接保存到对应的 `schematics` 文件夹。

### 3.3 尺寸计算
- 提供“计算结构大小”功能，实时反馈 Blender 坐标系下的长度、宽度 and 高度，确保导出尺寸符合预期。

---

## 4. 创建存档 (Create Level)

此模块允许用户在不启动 Minecraft 的情况下，预设一个完整的存档环境。

- **基础设置**：存档名称、出生点、难度、游戏模式（生存/创造等）、世界种子。
- **更多设置**：
  - 指令方块限制：设置单次执行最大更改数及连锁长度。
  - 自然环境：积雪层数、区块刻频率 (Random Tick Speed)。
- **玩家能力 (Ability)**：预览或修改玩家的飞行/行走速度、最大生命值、幸运值及战斗属性。
- **游戏规则 (Game Rules)**：提供超 40 项 MC 游戏规则开关（如：`keepInventory`, `doFireTick`, `mobGriefing` 等）。

---

## 5. 编辑与转换工具 (Edit)

这是本插件最核心的“黑科技”模块。

### 5.1 颜色-方块对照表 (Color-Block Dictionary)
- **用途**：建立颜色与方块 ID 之间的映射。
- **流程**：
  1. 点击“制作颜色-方块字典”。
  2. 在弹出界面中添加或编辑对照表，指定特定颜色对应的方块类型（方块、台阶、楼梯）。
  3. 可加载已有的对照表或清除当前配置。

### 5.2 替换方块 (Switch Blocks)
- **功能**：一键将模型中的特定方块 ID 批量替换为另一种方块。

### 5.3 网格转方块 (Mesh to Blocks)
- **ObjToBlocks**：将 3D 网格生成点云数据，是转换楼梯/台阶等复杂方块的前置步骤。
- **BlockBlender**：基于几何节点的强大转换器，将任意多边形网格瞬间“方块化”。

### 5.4 可视化工具
- **方块笔刷 (Block Brush)**：在 3D 视图中直接使用笔刷在模型上“绘制”指定的方块。
- **顶点色应用 (Paint Block)**：将 Blender 的顶点着色结果直接映射到方块材质上。
- **平均色提取**：从参考图片中提取平均颜色值，辅助对照表制作。

---

## 6. 环境管理 (Mod & Resource)

### 6.1 版本与 Mod
- 支持选择不同的 Minecraft 版本（如 1.20, 1.21 等）。
- 实时显示已加载的 Mod 列表，支持添加、移除及手动刷新。

### 6.2 资源包 (Resource Packs)
- 定义资源包路径，管理加载层级。
- 刷新功能将解压并重载资源包中的方块模型与材质。

---

## 7. 优化与动画
- **地图优化**：一键执行复杂的网格清理逻辑。
- **合并重叠面**：针对导入的模型，清理重叠导致的闪烁（Z-Fighting）问题。
- **植物摇摆 (Sway Animation)**：自动为植物类物体添加基于着色器或变形的摇摆动画效果。

> [!TIP]
> **使用建议**：大批量导入前请务必检查“合并重叠顶点”选项，这能显著提升后期编辑性能。导出的结构会默认放在插件配置的缓存目录或选定的存档目录下。
